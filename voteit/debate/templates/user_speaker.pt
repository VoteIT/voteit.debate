<tal:main xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="voteit.debate">

<div class="col-sm-12">
  <div class="list-group">
    <div class="list-group-item">
      <div class="row">
        <div class="col-sm-6">
          <h4>
            <span class="glyphicon glyphicon-bullhorn"></span>
            <span i18n:translate="">Speaker list</span>
          </h4>
        </div>
        <div class="col-sm-6">
          <a tal:condition="request.is_moderator"
            href="${request.resource_url(request.meeting, 'speaker_list_action',
                    query = {'action': 'add', 'ai_name': context.__name__})}"
            class="btn btn-default btn-sm"
            i18n:translate="">New</a>
          <a tal:condition="request.is_moderator"
            class="btn btn-default btn-sm"
            href="${request.resource_url(context, 'manage_speaker_list')}"
            i18n:translate="">Manage</a>
          <a tal:condition="request.is_moderator"
            href="${request.resource_url(request.meeting, 'speaker_list_settings')}"
            class="btn btn-default btn-sm">
            <span class="glyphicon glyphicon-cog"></span>
            <span i18n:translate="">Settings</span>
          </a>
          <a href="${request.resource_url(request.meeting, 'speaker_statistics')}"
            class="btn btn-default btn-sm">
            <span class="glyphicon glyphicon-stats"></span>
            <span i18n:translate="">Statistics</span>
          </a>
        
        </div>
      </div>
    </div>

    <tal:iterate repeat="sl speaker_lists">
      <div class="list-group-item">
        <div class="sl_title">
          <h4>
            <span tal:condition="active_list == sl and 'active' or None" class="glyphicon glyphicon-arrow-right"></span>
            ${sl.title}
            <small tal:condition="active_list == sl and 'active' or None" i18n:translate="">Currently active</small>
          </h4>
        </div>
        <div class="row">
          <div class="col-sm-6">
            <span tal:condition="sl.state == 'open'" class="glyphicon glyphicon-play-circle text-success"></span>
            <span tal:condition="sl.state == 'closed'" class="glyphicon glyphicon-lock text-danger"></span>
            ${sl.get_state_title()} - ${len(sl.speakers)} <span i18n:translate="">in queue</span>

            <div class="sl_stats">
              <tal:not_in_list condition="pn != None and pn not in sl.speakers and sl.state == 'open'">
                <div class="text-muted" i18n:translate="">
                  You will enter list att position
                  <b tal:content="sl.get_position(pn) + 1" i18n:name="num"></b>
                  if you wish to speak
                </div>
              </tal:not_in_list>
              <tal:in_list condition="pn in sl.speakers">
                <div class="text-muted" i18n:translate="">
                  <b tal:content="sl.speakers.index(pn)" i18n:name="num"></b>
                  speakers before you
                </div>
              </tal:in_list>
            </div>
          </div>
          <div class="col-sm-6 sl_controls">
            <tal:no_pn condition="pn == None">
              <span class="text-muted" i18n:translate="need_pn_to_enter_list">You need a participant number to use this.</span>
            </tal:no_pn>
            <tal:not_in_list condition="pn and show_add(sl, pn)|False">
              <a tal:condition="not over_limit(sl, pn)"
                data-sl-user-control
                href="${request.resource_url(context, '_user_speaker_lists', query = {'action': 'add', 'list_name': sl.name})}"
                class="btn btn-success" i18n:translate="">Add yourself</a>
              <span class="text-muted" tal:condition="over_limit(sl, pn)"
                    i18n:translate="over_limit_notice">
                    You've already spoken
                    <tal:num i18n:name="count" tal:content="max_times_in_list">2</tal:num> times.
              </span>
            </tal:not_in_list>
            <tal:in_list condition="pn in sl.speakers">
              <a href="${request.resource_url(context, '_user_speaker_lists', query = {'action': 'remove', 'list_name': sl.name})}"
                data-sl-user-control
                class="btn btn-warning" i18n:translate="">Remove yourself</a>
            </tal:in_list>
          </div>
        </div>
      </div>
    </tal:iterate>
  </div>
</div>
</tal:main>
