<tal:main xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="voteit.debate">

<div class="list-group">
  <tal:iter repeat="sl context_lists">

  <div class="list-group-item ${(view.active_name and sl.name == view.active_name) and 'active' or None}">
    <div class="btn-group pull-right">
      <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
        <span class="glyphicon glyphicon-cog"></span>
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="${request.resource_url(request.meeting, 'speaker_list_action',
                                          query = {'action': 'set_state', 'list_name': sl.name, 'state': 'closed', 'ai_name': context.__name__})}"
             class="list_state" tal:condition="sl.state != u'closed'">
             <span class="glyphicon glyphicon-lock text-danger"></span>
             <span i18n:translate="">Close list</span>
           </a>
          <a href="${request.resource_url(request.meeting, 'speaker_list_action',
                                          query = {'action': 'set_state', 'list_name': sl.name, 'state': 'open', 'ai_name': context.__name__})}"
             class="list_state"
             tal:condition="sl.state != u'open'">
             <span class="glyphicon glyphicon-play-circle text-success"></span>
             <span i18n:translate="">Open list</span>
           </a>
        </li>
        <li>
          <a class="rename_sl">
            <span class="glyphicon glyphicon-edit"></span>
            <span i18n:translate="">Rename</span>
          </a>
        </li>
        <li class="divider"></li>
        <li>
          <a href="${request.resource_url(request.meeting, 'speaker_list_action',
                     query = {'action': 'populate_from_proposals', 'list_name': sl.name, 'ai_name': context.__name__})}"
             i18n:translate="">Populate from proposals</a>
        </li>
        <li class="divider"></li>
        <li>
          <a href="${request.resource_url(request.meeting, 'speaker_list_action',
                     query = {'action': 'delete', 'list_name': sl.name, 'ai_name': context.__name__})}"
             i18n:translate="">Delete</a>
        </li>
      </ul>
    </div><!-- btn-group -->

    <a href="${request.resource_url(context, '_activate_slist', sl.name)}"
       class="sl_title">
       <span tal:attributes="class sl.state == 'open' and 'iconpadding icon ongoing' or 'iconpadding icon closed'">
       </span>
       <span tal:condition="sl.state == 'open'" class="glyphicon glyphicon-play-circle"></span>
       <span tal:condition="sl.state == 'closed'" class="glyphicon glyphicon-lock"></span>
       ${sl.title}
    </a>
    <form action="${request.resource_url(request.meeting, 'speaker_list_action', query = {'action': 'rename', 'list_name': sl.name})}"
        method="GET" class="rename_form" style="display: none;">
        <input name="list_title_rename" class="form-control" value="${sl.title}" />
    </form>
  </div>
  </tal:iter>
</div>

<script language="javascript" type="text/javascript">
    //$("#speaker_list_controls a").on("click", generic_speaker_list_get_actions);
    /*
    $(".rename_sl").on("click", rename_speaker_show);
    $(".rename_form").on("submit", rename_speaker_submit);
    */
</script>
</tal:main>
